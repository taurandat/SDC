(carnd-term1) carnd@ip-172-31-2-215:~$ python model.py
I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcublas.so locally
I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcudnn.so locally
I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcufft.so locally
I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcuda.so.1 locally
I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcurand.so locally
Using TensorFlow backend.
____________________________________________________________________________________________________
Layer (type)                     Output Shape          Param #     Connected to
====================================================================================================
lambda_1 (Lambda)                (None, 64, 64, 3)     0           lambda_input_1[0][0]
____________________________________________________________________________________________________
convolution2d_1 (Convolution2D)  (None, 32, 32, 24)    1824        lambda_1[0][0]
____________________________________________________________________________________________________
batchnormalization_1 (BatchNorma (None, 32, 32, 24)    96          convolution2d_1[0][0]
____________________________________________________________________________________________________
activation_1 (Activation)        (None, 32, 32, 24)    0           batchnormalization_1[0][0]
____________________________________________________________________________________________________
maxpooling2d_1 (MaxPooling2D)    (None, 31, 31, 24)    0           activation_1[0][0]
____________________________________________________________________________________________________
dropout_1 (Dropout)              (None, 31, 31, 24)    0           maxpooling2d_1[0][0]
____________________________________________________________________________________________________
convolution2d_2 (Convolution2D)  (None, 16, 16, 36)    21636       dropout_1[0][0]
____________________________________________________________________________________________________
batchnormalization_2 (BatchNorma (None, 16, 16, 36)    144         convolution2d_2[0][0]
____________________________________________________________________________________________________
activation_2 (Activation)        (None, 16, 16, 36)    0           batchnormalization_2[0][0]
____________________________________________________________________________________________________
maxpooling2d_2 (MaxPooling2D)    (None, 15, 15, 36)    0           activation_2[0][0]
____________________________________________________________________________________________________
dropout_2 (Dropout)              (None, 15, 15, 36)    0           maxpooling2d_2[0][0]
____________________________________________________________________________________________________
convolution2d_3 (Convolution2D)  (None, 8, 8, 48)      43248       dropout_2[0][0]
____________________________________________________________________________________________________
batchnormalization_3 (BatchNorma (None, 8, 8, 48)      192         convolution2d_3[0][0]
____________________________________________________________________________________________________
activation_3 (Activation)        (None, 8, 8, 48)      0           batchnormalization_3[0][0]
____________________________________________________________________________________________________
maxpooling2d_3 (MaxPooling2D)    (None, 7, 7, 48)      0           activation_3[0][0]
____________________________________________________________________________________________________
dropout_3 (Dropout)              (None, 7, 7, 48)      0           maxpooling2d_3[0][0]
____________________________________________________________________________________________________
convolution2d_4 (Convolution2D)  (None, 7, 7, 64)      27712       dropout_3[0][0]
____________________________________________________________________________________________________
batchnormalization_4 (BatchNorma (None, 7, 7, 64)      256         convolution2d_4[0][0]
____________________________________________________________________________________________________
activation_4 (Activation)        (None, 7, 7, 64)      0           batchnormalization_4[0][0]
____________________________________________________________________________________________________
maxpooling2d_4 (MaxPooling2D)    (None, 6, 6, 64)      0           activation_4[0][0]
____________________________________________________________________________________________________
dropout_4 (Dropout)              (None, 6, 6, 64)      0           maxpooling2d_4[0][0]
____________________________________________________________________________________________________
convolution2d_5 (Convolution2D)  (None, 6, 6, 64)      36928       dropout_4[0][0]
____________________________________________________________________________________________________
batchnormalization_5 (BatchNorma (None, 6, 6, 64)      256         convolution2d_5[0][0]
____________________________________________________________________________________________________
activation_5 (Activation)        (None, 6, 6, 64)      0           batchnormalization_5[0][0]
____________________________________________________________________________________________________
maxpooling2d_5 (MaxPooling2D)    (None, 5, 5, 64)      0           activation_5[0][0]
____________________________________________________________________________________________________
dropout_5 (Dropout)              (None, 5, 5, 64)      0           maxpooling2d_5[0][0]
____________________________________________________________________________________________________
flatten_1 (Flatten)              (None, 1600)          0           dropout_5[0][0]
____________________________________________________________________________________________________
dense_1 (Dense)                  (None, 1164)          1863564     flatten_1[0][0]
____________________________________________________________________________________________________
activation_6 (Activation)        (None, 1164)          0           dense_1[0][0]
____________________________________________________________________________________________________
dense_2 (Dense)                  (None, 100)           116500      activation_6[0][0]
____________________________________________________________________________________________________
activation_7 (Activation)        (None, 100)           0           dense_2[0][0]
____________________________________________________________________________________________________
dense_3 (Dense)                  (None, 50)            5050        activation_7[0][0]
____________________________________________________________________________________________________
activation_8 (Activation)        (None, 50)            0           dense_3[0][0]
____________________________________________________________________________________________________
dense_4 (Dense)                  (None, 10)            510         activation_8[0][0]
____________________________________________________________________________________________________
activation_9 (Activation)        (None, 10)            0           dense_4[0][0]
____________________________________________________________________________________________________
dense_5 (Dense)                  (None, 1)             11          activation_9[0][0]
====================================================================================================
Total params: 2,117,927
Trainable params: 2,117,455
Non-trainable params: 472
____________________________________________________________________________________________________
Epoch 1/20
I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:937] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
I tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 0 with properties:
name: GRID K520
major: 3 minor: 0 memoryClockRate (GHz) 0.797
pciBusID 0000:00:03.0
Total memory: 3.94GiB
Free memory: 3.91GiB
I tensorflow/core/common_runtime/gpu/gpu_device.cc:906] DMA: 0
I tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 0:   Y
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GRID K520, pci bus id: 0000:00:03.0)
25600/25600 [==============================] - 162s - loss: 0.0883 - val_loss: 0.1071
Epoch 2/20
25600/25600 [==============================] - 154s - loss: 0.0302 - val_loss: 0.0489
Epoch 3/20
25600/25600 [==============================] - 155s - loss: 0.0246 - val_loss: 0.0269
Epoch 4/20
25600/25600 [==============================] - 152s - loss: 0.0211 - val_loss: 0.0237
Epoch 5/20
25600/25600 [==============================] - 152s - loss: 0.0181 - val_loss: 0.0225
Epoch 6/20
25600/25600 [==============================] - 149s - loss: 0.0163 - val_loss: 0.0161
Epoch 7/20
25600/25600 [==============================] - 151s - loss: 0.0150 - val_loss: 0.0186
Epoch 8/20
25600/25600 [==============================] - 151s - loss: 0.0141 - val_loss: 0.0218
Epoch 9/20
25600/25600 [==============================] - 150s - loss: 0.0136 - val_loss: 0.0144
Epoch 10/20
25600/25600 [==============================] - 149s - loss: 0.0132 - val_loss: 0.0139
Epoch 11/20
25600/25600 [==============================] - 148s - loss: 0.0128 - val_loss: 0.0134
Epoch 12/20
25600/25600 [==============================] - 150s - loss: 0.0126 - val_loss: 0.0146
Epoch 13/20
25600/25600 [==============================] - 151s - loss: 0.0124 - val_loss: 0.0122
Epoch 14/20
25600/25600 [==============================] - 151s - loss: 0.0123 - val_loss: 0.0129
Epoch 15/20
25600/25600 [==============================] - 151s - loss: 0.0117 - val_loss: 0.0106
Epoch 16/20
25600/25600 [==============================] - 150s - loss: 0.0120 - val_loss: 0.0160
Epoch 17/20
25600/25600 [==============================] - 149s - loss: 0.0115 - val_loss: 0.0108
Epoch 18/20
25600/25600 [==============================] - 148s - loss: 0.0117 - val_loss: 0.0118
Epoch 19/20
25600/25600 [==============================] - 151s - loss: 0.0118 - val_loss: 0.0141
Epoch 20/20
25600/25600 [==============================] - 151s - loss: 0.0113 - val_loss: 0.0124
